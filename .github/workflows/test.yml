name: Test

on:
  workflow_dispatch:

env:
  # Customize the CMake build type here (Release, Debug, RelWithDebInfo, etc.)
  BUILD_TYPE: Release

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest]
    runs-on: ${{ matrix.os }}

    steps:
    - uses: actions/checkout@v3

    - name: Succeed
      id: test_succeed 
      run: run exit 0

    - name: Build Badge
      uses: schneegans/dynamic-badges-action@v1.6.0
      with:
          auth: ${{ secrets.GIST_SECRET }}
          gistID: 6935a607aff6233d996070495bba70b7
          filename: ${{ matrix.os}}-test-succeed.json
          label: Test
          message: ${{ steps.test_succeed.outcome == 'success' && success || failed}}
          color: green

    - name: Fail
      id: test_fail
      run: run exit 1
      continue-on-error: true

    - name: Build Badge
      uses: schneegans/dynamic-badges-action@v1.6.0
      with:
          auth: ${{ secrets.GIST_SECRET }}
          gistID: 6935a607aff6233d996070495bba70b7
          filename: ${{ matrix.os}}-test-failed.json
          label: Test
          message: ${{ steps.test_fail.outcome == 'success' && success || failed}}
          color: red

      
